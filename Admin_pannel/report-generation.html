<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>User Page</title>
  <link rel="stylesheet" href="../common/header.css">
  <link rel="stylesheet" href="report-generation.css" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet" />
  <script src="https://kit.fontawesome.com/a9dbad3c27.js" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>

  <header class="header">
    <div></div>
    <img src="../byd.png" alt="BYD Furniture Logo" class="logo" />
    <div></div>
  </header>
    
    <h1>üìä Generate Report</h1>
    <div class="form-group">
      <label for="fromDate">From Date</label>
      <input type="date" id="fromDate">
    </div>
    <div class="form-group">
      <label for="toDate">To Date</label>
      <input type="date" id="toDate">
    </div>
    <div class="form-group">
      <label for="reportType">Report Type</label>
      <select id="reportType">
        <option value="purchase">Purchase</option>
        <option value="product">Product</option>
      </select>
    </div>
    <div class="form-group" id="productGroupFilter" style="display: none;">
      <label for="productGroup">Select Product Group</label>
      <select id="productGroup">
        <option value="00">Sofa</option>
        <option value="02">Dining Tables</option>
        <option value="03">Chairs</option>
        <option value="04">Center Tables</option>
        <option value="05">Beds</option>
        <option value="06">Gari</option>
        <option value="07">Coffee Tables</option>
        <option value="08">Photo Frames</option>
        <option value="09">Mentafs</option>
        <option value="10">Mabrat</option>
        <option value="20">Consoles</option>
        <option value="30">TV Stands</option>
        <option value="40">Ababa Maskemecha</option>
        <option value="50">Ferash</option>
        <option value="60">Fur</option>
        <option value="70">Desks</option>
        <option value="80">Bed Side</option>
        <option value="90">Comforts</option>
      </select>
    </div>
    <div class="form-group">
      <label>Select Fields to Include</label>
      <div class="checkbox-group">
        <label><input type="checkbox" class="fieldCheckbox" value="Customer"> Customer</label>
        <label><input type="checkbox" class="fieldCheckbox" value="Product"> Product</label>
        <label><input type="checkbox" class="fieldCheckbox" value="Seller"> Seller</label>
        <label><input type="checkbox" class="fieldCheckbox" value="Price"> Price</label>
        <label><input type="checkbox" class="fieldCheckbox" value="Qty"> Quantity</label>
        <label><input type="checkbox" class="fieldCheckbox" value="Date"> Date</label>
      </div>
    </div>
    <button id="generateBtn">‚¨áÔ∏è Generate Excel</button>
  
    <script>
      document.getElementById("reportType").addEventListener("change", function() {
        const type = this.value;
        document.getElementById("productGroupFilter").style.display = type === "product" ? "block" : "none";
      });
  
      document.getElementById("generateBtn").addEventListener("click", () => {
        const selectedFields = [...document.querySelectorAll(".fieldCheckbox:checked")].map(cb => cb.value);
  
        // Simulated data generation for demonstration
        const data = [
          { Customer: "Makdi", Product: "Sofa", Seller: "Sifan", Price: 45000, Qty: 1, Date: "2017-12-19" },
          { Customer: "Dina", Product: "Chair", Seller: "Robel", Price: 2500, Qty: 4, Date: "2017-12-20" }
        ];
  
        const filtered = data.map(row => {
          const filteredRow = {};
          selectedFields.forEach(field => {
            filteredRow[field] = row[field];
          });
          return filteredRow;
        });
  
        const ws = XLSX.utils.json_to_sheet(filtered);
        const wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, "Report");
        XLSX.writeFile(wb, "generated_report.xlsx");
      });
    </script>
    </body>
    </html>
    